pipeline {
    agent any
    options {
        retry(3)
    }
    tools {
            // Install the Maven version configured as "M3" and add it to the path.
            maven "maven3.6"
            jdk "jdk1.8"
        }
    triggers{cron('00 23 * * *')}
    stages {
        stage('checkout') {
            steps {
                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '111', url: 'https://github.com/LeechenLove/javaapp.git']]])
            }
        }
        stage('mvn package') {
            steps {
                sh 'mvn clean package'
            }
        }
        stage('deploy war') {
            steps{
                deploy adapters: [tomcat8(credentialsId: 'tomcat1', path: '', url: 'http://43.138.194.213:8081/')], contextPath: '/javaapp', war: '**/*.war'
            }
        }
    }
}